# Task Planning Patterns

Planning_Workflow:
  phases:
    explore:
      description: "Research and understand problem space"
      activities:
        - "Analyze existing code structure"
        - "Identify affected modules"
        - "Research similar implementations"
        - "Understand constraints"
      outputs:
        - "Problem understanding document"
        - "Affected files list"
        - "Risk assessment"
    plan:
      description: "Create detailed implementation strategy"
      activities:
        - "Break down into subtasks"
        - "Define boundaries"
        - "Identify dependencies"
        - "Create verification targets"
      outputs:
        - "Task specification"
        - "Subtask breakdown"
        - "Success criteria"
    implement:
      description: "Execute with clear boundaries"
      activities:
        - "Follow subtask sequence"
        - "Update registry continuously"
        - "Document in scratchpad"
        - "Test incrementally"
      outputs:
        - "Working code"
        - "Updated tests"
        - "Scratchpad learnings"
    verify:
      description: "Ensure requirements met"
      activities:
        - "Run all tests"
        - "Check visual targets"
        - "Validate acceptance criteria"
        - "Ensure no overfitting"
      outputs:
        - "Test results"
        - "Verification report"
        - "Completion confirmation"

Complexity_Analysis:
  factors:
    scope:
      low: "1-2 files, single module"
      medium: "3-5 files, 2-3 modules"
      high: "6+ files, multiple modules"
    dependencies:
      low: "No external deps"
      medium: "1-2 well-known deps"
      high: "Multiple or unknown deps"
    risk:
      low: "Isolated changes"
      medium: "Some integration risk"
      high: "Core system changes"
    testing:
      low: "Unit tests only"
      medium: "Integration tests needed"
      high: "End-to-end tests required"
  scoring:
    - "Sum all factor scores"
    - "0-4: Simple task (3-4 subtasks)"
    - "5-8: Standard task (4-6 subtasks)"
    - "9-12: Complex task (6-8 subtasks)"
    - ">12: Consider splitting tasks"

Subtask_Guidelines:
  optimal_size:
    time: "1-3 hours"
    complexity: "Single focused objective"
    testability: "Independently verifiable"
  structure:
    title: "Clear action verb + specific outcome"
    description: "What, why, and success criteria"
    context: "Relevant docs, examples, patterns"
    estimation: "Realistic time in hours"
  sequencing:
    - "Dependencies first"
    - "Risky changes early"
    - "Integration in middle"
    - "Polish and docs last"
  context_preservation:
    - "Link related docs"
    - "Reference similar code"
    - "Note discovered patterns"
    - "Share between subtasks"

Boundary_Definition:
  allowed_paths:
    specificity: "Exact directories only"
    examples:
      - "src/modules/market-collector/"
      - "tests/market-collector/"
      - "src/db/migrations/"
    verification: "Agent can ONLY modify these"
  forbidden_paths:
    critical:
      - "tasks/task-registry.json (except status)"
      - ".claude/commands/"
      - "wrangler.toml"
      - ".env files"
    isolation:
      - "Other task workspaces"
      - "Unrelated modules"
      - "System configurations"
  workspace_setup:
    - "Create task-X folder"
    - "Initialize spec.md"
    - "Create empty scratchpad.md"
    - "Make files/ directory"
    - "Add targets/ for verification"

Verification_Targets:
  types:
    visual:
      description: "Screenshots or UI examples"
      storage: "tasks/active/task-X/targets/"
      format: "PNG, JPG, GIF"
      usage: "Compare implementation output"
    test_output:
      description: "Expected test results"
      format: "Text, JSON, logs"
      validation: "Exact or pattern match"
    acceptance_criteria:
      description: "Checklist of requirements"
      format: "Markdown checkboxes"
      completion: "All boxes checked"
  implementation:
    - "Define targets in planning phase"
    - "Store in task workspace"
    - "Reference in subtasks"
    - "Validate during execution"
    - "Archive with completion"